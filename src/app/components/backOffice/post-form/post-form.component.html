
<section class="container">

<form class="formulaire-complet" [formGroup]="postForm" (ngSubmit)="onSubmit()">

    <div class="container-entete">
        <img src="assets/illustration/back-office.png" alt="back-office">
        <div class="entete-titre">
            @if(isNewPost){
            <h1>Ajouter une publication</h1>
            }@else (){
            <h1>Modifier la publication</h1>
            }


            <div class="mesCat">
                <div>
                    <input class="cat" required type="radio" id="litterature" formControlName="categorie" name="categorie" 
                    value="litterature">
                    <label for="litterature">Littérature</label>
                </div>
              <div>
                <input class="cat" required type="radio" id="cinema" formControlName="categorie" name="categorie" 
                value="cinema">
                <label for="cinema">Cinéma</label>

              </div>
                   <div>
                    <input class="cat" required type="radio" id="citation" formControlName="categorie" name="categorie" 
                    value="citation">
                    <label for="citation">Citation</label> 
                </div>              
            </div>
        </div>
    </div>


    <!-- Nom Auteur -->
    <div class="postForm-champ">
        <label for="auteur">Auteur :</label>
        <!-- <input class="input-form" type="text" id="nom" formControlName="nom"> -->
        <select class="input-form" name="auteur" id="auteur" formControlName="auteur"  (change)="onAuteurChange($event)">
            <option value=""></option>
            @for(author of listOfAuthors; track author.id){
            <option [value]="author.name">{{author.name}}</option>
        }
        <option value="autre">Autre (précisez)</option>
        </select>
        
        @if(showCustomInput){
        <div class="postForm-champ" >
            <label for="autreAuteur">Nouvel auteur :</label>
            <input type="text" class="input-form" id="autreAuteur" name="autreAuteur" [(ngModel)]="nouvelAuteur">
        </div>
    }
    </div>


    <!-- Titre -->
    <div class="postForm-champ">
        <label for="titre">Titre :</label>
        @if (post) {
        <input class="input-form" name="titre" id="titre" formControlName="titre">
        } @else {
        <input class="input-form" name="titre" id="titre" formControlName="titre">
        }

    </div>

    <!-- Catégorie -->
    <div class="postForm-champ">
        <label for="theme">Theme :</label>
        <select class="input-form" name="theme" id="theme" formControlName="theme">

            <option value=""></option>
            @for(theme of listOfThemes; track theme){
            <option value="{{theme}}">{{theme}}</option>
            }
           
        </select>
    </div>

    <!-- Publication -->
    <div class="postForm-champ">
        <label for="publication">Publication:</label>
        <textarea class="publication" name="publication" id="publication" cols="30" rows="10"
            formControlName="publication"></textarea>
    </div>

    
    <!-- Photo de couverture -->
    <div class="postForm-champ post-photo">
        <label for="photo">Photo de couverture :</label>
        <div class="photo-image">

            <!-- J'affiche mon patch et son changement si je suis sur modifier -->
            <input class="input-photo" type="file" accept="assets/*" id="photo" formControlName="photo"
                (change)="onFileSelected($event)" value="">


            @if(isEmptyImage){
            <img class="photo notSelected" src="assets/illustration/placeholder.jpg" alt="Image placeholder">
            }
            @if(selectedFileUrl){
            <img class="photo selected" [src]="selectedFileUrl" [alt]="selectedFileUrl">
            }
            @if(imageUrl){
            <img class="photo selected" [src]="imageUrl" [alt]="imageUrl">
            }

        </div>
    </div>


    <!-- Boutons -->
    <div class="postForm-champ">
        <button>Annuler</button>
        <button type="submit" >Publier</button>
    </div>

</form>

</section>